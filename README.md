## Minimal GN project

[GN](https://chromium.googlesource.com/chromium/src/tools/gn/+/HEAD/README.md) is a meta-build-system invented by
the Chromium authors to build Chromium on multiple platform. It generates [NinjaBuild](https://ninja-build.org/)
files which are then used to build the actual product.

It is a great build system, but heavily tied to Chromium. Only very few projects use it outside of Chromium and
there is just very little documentation how to use it.

This project is a minimalistic `Hello, World!` cross platform GN build. It is ment to help others to learn more
about GN and serve as a boilerplate for your own projects.


### Precenditions

You need to install Chromium's  [`depot_tools`](http://www.chromium.org/developers/how-tos/install-depot-tools).


### Getting the code

Create a `.gclient` file in an empty directory with this contents:
```
solutions = [{
  'managed': False,
  'name': 'src',
  'url': 'git@github.com:abarth/tau.git',
  'deps_file': 'DEPS',
}]
```

In this directory, run `gclient sync`. This will pull this project and all its dependancies.


### Directory structure of minimal GN project

Once gclient finished, you will find a `src` directory next to your `.client` file with this structure: 

```
 src (needs to be under GIT management)
  |
  +-- [build] --> https://chromium.googlesource.com/chromium/src/build.git@xxxx
  |
  +-- [buildtools] --> https://chromium.googlesource.com/chromium/buildtools.git@xxx
  |
  +-- tools
  |    |
  |    `-- [gyp] --> https://chromium.googlesource.com/external/gyp.git@c61b0b35c8396bfd59efc6cfc11401d912b0f510
  |
  +-- build_overrides
  |    |
  |    `-- build.gni
  |
  +-- (out) (generated by GN)
  |
  +-- lib
  |    |
  |    +-- say_hello.cc
  |    |
  |    +-- say_hello.h
  |    |
  |    `-- BUILD.GN  (defining the 'say_hello' static library)
  |
  +-- app
  |    |
  |    +-- hello_world.cc
  |    |
  |    `-- BUILD.GN (defining the 'hello_world' executable)
  |
  +-- .gn  (pointing to BUILDCONFIG in //build directory)
  |
  +-- BUILD.gn  (umbrella project pointing to sub-projects, '/app' in our case)
  |
  `-- DEPS  (optional, required to use gclient to organize the project)
```

Please note that the topmost directory must be under git management. This is required by GN. You cannot setup a GN built
project in a plain vanilla folder.


### File content

This setup pulls many parts from the Chromium build. The project specific custom parts have the following content and meaning:

| File | Content |
|------+---------|
| build_overrides/build.gni | (yet unknown) |
| app/*.cc,*.h | Source files of application |
| app/BUILD.gn | GN project file defining this application |
| .gn | pointing to the buildconfig and secondary_source |
| BUILD.gn | top-level umbrella project pulling all sub-projects together |
| DEPS | (optional) declares dependencies so that this project can be managed by gclient |


### Build the project

In the `src` directory, run this command:

`gn gen out`

This will create a Ninja build files in the new directoty `out`. Next, we run `ninja` to build our app:

`ninja -C out`

The `hello_world` executable has now been created in `out`. You can replace the name `out` with any name of your liking.


### IDE integration

You will always build with Ninja, not the IDE. But there are integrations for different IDEs. GN can generate project files
for different IDEs that then invoke GN and Ninja to build the project. For example:

`gn gen --ide=vs2015 out`


